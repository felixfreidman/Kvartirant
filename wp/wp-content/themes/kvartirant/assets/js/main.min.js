"use strict";var customSelect,selectContainer,selectOptions,savedString,budgetInput,checkboxesRepair=document.querySelectorAll(".repairCheckbox"),resetRepair=document.querySelector(".resetCheckboxRepair"),checkboxesColiver=document.querySelectorAll(".coliverCheckbox"),resetColiver=document.querySelector(".resetCheckboxColiver"),checkboxesRoom=document.querySelectorAll(".roomCheckbox"),resetRoom=document.querySelector(".resetCheckboxRoom");function resetCheckboxRepair(){var t=0;checkboxesRepair.forEach(function(e){e.classList.contains("custom-checkbox--active")&&t++,1<t&&resetRepair.classList.remove("custom-checkbox--active"),0==t&&resetRepair.classList.add("custom-checkbox--active")})}function resetCheckboxColiver(){var t=0;checkboxesColiver.forEach(function(e){e.classList.contains("custom-checkbox--active")&&t++,1<t&&resetColiver.classList.remove("custom-checkbox--active"),0==t&&resetColiver.classList.add("custom-checkbox--active")})}function resetCheckboxRoom(){var t=0;checkboxesRoom.forEach(function(e){e.classList.contains("custom-checkbox--active")&&t++}),0==t&&resetRoom.classList.add("custom-checkbox--active")}checkboxesRepair.forEach(function(e){e.addEventListener("click",function(){e.classList.contains("resetCheckboxRepair")?e.classList.contains("resetCheckboxRepair")&&checkboxesRepair.forEach(function(e){e.classList.remove("custom-checkbox--active"),resetRepair.classList.add("custom-checkbox--active")}):(e.classList.toggle("custom-checkbox--active"),setTimeout(resetCheckboxRepair,100))})}),checkboxesColiver.forEach(function(e){e.addEventListener("click",function(){e.classList.contains("resetCheckboxColiver")?e.classList.contains("resetCheckboxColiver")&&checkboxesColiver.forEach(function(e){e.classList.remove("custom-checkbox--active"),resetColiver.classList.add("custom-checkbox--active")}):(e.classList.toggle("custom-checkbox--active"),setTimeout(resetCheckboxColiver,100))})}),checkboxesRoom.forEach(function(e){e.addEventListener("click",function(){e.classList.toggle("custom-checkbox--active"),setTimeout(resetCheckboxRoom,100)})}),document.getElementById("customSelect")&&(customSelect=document.getElementById("customSelect"),selectContainer=document.querySelector(".pref-slide__select-container"),selectOptions=selectContainer.querySelectorAll(".pref-slide__option"),savedString=customSelect.textContent,customSelect.addEventListener("click",function(){setTimeout(function(){selectContainer.classList.remove("js--hidden")},100)}),window.onclick=function(e){e.target==selectContainer||e.target.classList.contains("pref-slide__option")||e.target.classList.contains("pref-slide__select")||selectContainer.classList.add("js--hidden")},selectOptions.forEach(function(e,t){e.addEventListener("click",function(){0!=t?(selectOptions[0].classList.remove("pref-slide__option--active"),e.classList.toggle("pref-slide__option--active"),customSelect.textContent=customSelect.textContent.replace("Все районы",""),""==customSelect.textContent?customSelect.textContent="".concat(e.textContent.slice(0,5)):customSelect.textContent="".concat(customSelect.textContent,", ").concat(e.textContent.slice(0,5))):(selectOptions.forEach(function(e){e.classList.remove("pref-slide__option--active")}),e.classList.add("pref-slide__option--active"),customSelect.textContent="Все районы")})})),document.getElementById("userBudgetInput")&&($(function(){$("#userBudget").slider({range:"min",min:0,max:2e5,step:1e3,value:5e4,slide:function(e,t){$("#userBudgetInput").val(t.value)}})}),(budgetInput=document.getElementById("userBudgetInput")).addEventListener("input",function(){var e=budgetInput.value;$("#userBudget").slider("value",e)}));var submitForm=document.querySelector(".submitForm"),roomsAmount="",budget="",areaSearch="",repairPrefs="",coliverPrefs="",prefsObject={roomsAmount:"",budget:"",areaSearch:"",repairPrefs:"",coliverPrefs:""};function getRoomsAmount(){document.querySelectorAll(".roomCheckbox").forEach(function(e){e.classList.contains("custom-checkbox--active")&&(e=e.textContent,roomsAmount=roomsAmount+e+", ")}),roomsAmount=(roomsAmount=roomsAmount.trim()).slice(0,roomsAmount.length-1)}function getRepairPrefs(){document.querySelectorAll(".repairCheckbox").forEach(function(e){e.classList.contains("custom-checkbox--active")&&(e=e.getAttribute("data-value"),repairPrefs=repairPrefs+e+", ")}),repairPrefs=(repairPrefs=repairPrefs.trim()).slice(0,repairPrefs.length-1)}function getColiverPrefs(){document.querySelectorAll(".coliverCheckbox").forEach(function(e){e.classList.contains("custom-checkbox--active")&&(e=e.getAttribute("data-value"),coliverPrefs=coliverPrefs+e+", ")}),coliverPrefs=(coliverPrefs=coliverPrefs.trim()).slice(0,coliverPrefs.length-1)}submitForm.addEventListener("click",function(){submitForm.classList.add("js--inactive"),getRoomsAmount(),getRepairPrefs(),getColiverPrefs(),budget=document.getElementById("userBudgetInput").value,areaSearch=document.getElementById("customSelect").textContent;var e=document.getElementById("roomsAmount"),t=document.getElementById("budgetAmount"),c=document.getElementById("areaSearch"),o=document.getElementById("repairPrefs"),s=document.getElementById("coliverPrefs");e.value=roomsAmount,t.value=budget,c.value=areaSearch,o.value=repairPrefs,s.value=coliverPrefs,document.getElementById("prefsForm").submit()});var sliderContainers=document.querySelectorAll(".swiper-adt"),allNextButtons=(sliderContainers.forEach(function(e,t){var c=e.querySelector(".swiper-pagination");e.classList.add("swiper-adt--".concat(t)),c.classList.add("swiper-pagination--".concat(t)),new Swiper(".swiper-adt--".concat(t),{speed:400,spaceBetween:0,slidesPerView:1,effect:"cards",direction:"horizontal",loop:!0,pagination:{el:".swiper-pagination--".concat(t),clickable:!0}})}),document.querySelectorAll(".pref-slide__button")),allSlides=document.querySelectorAll(".pref-slide");function activateForms(){var e,t,c,o,s,n;document.querySelector(".signin-form")&&(e=document.querySelector(".signin-form"),t=document.querySelector(".signup-form"),c=e.querySelector(".caption"),o=t.querySelector(".caption"),s=document.getElementById("signin-special"),n=document.getElementById("signup-special"),c.addEventListener("click",function(){e.classList.add("js--hidden"),t.classList.remove("js--hidden")}),o.addEventListener("click",function(){e.classList.remove("js--hidden"),t.classList.add("js--hidden")}),s.addEventListener("click",function(){localStorage.setItem("logged",!0)}),n.addEventListener("click",function(){localStorage.setItem("logged",!0)}))}allNextButtons.forEach(function(e,t){2!==t&&e.addEventListener("click",function(){allSlides[t].classList.add("js--hidden"),allSlides[t+1].classList.remove("js--hidden")})}),setTimeout(activateForms,300);var account,opener,timers=document.querySelectorAll(".message-time"),formContainer=document.querySelectorAll(".chat-form");function modifyTime(){timers.forEach(function(e){var t=(t=e.textContent).slice(11,17);e.textContent=t})}function activateLogout(){var e,t;document.getElementById("menu-header")&&(e=document.getElementById("menu-header").querySelector("a"),(t=document.getElementById("logoutLink")).href=e.href,t.addEventListener("click",function(){localStorage.getItem("logged")&&(localStorage.setItem("logged",!1),document.querySelector(".account").classList.remove("account--logged"))}))}modifyTime(),setTimeout(activateLogout,300),localStorage.getItem("logged")&&"true"==localStorage.getItem("logged")&&(account=document.querySelector(".account")).classList.add("account--logged"),document.getElementById("menuOpener")&&((opener=document.getElementById("menuOpener")).addEventListener("click",function(){opener.classList.add("opener--active")}),window.onclick=function(e){e.target==opener||e.target.classList.contains("checkSpan")||opener.classList.remove("opener--active")});var allNavLinks,sectionHeader,avatarFrame,pageLocation=window.location.href,props=["Ваш профиль","Ваши сообщения"];(pageLocation.includes("profile")||pageLocation.includes("subscription"))&&(allNavLinks=document.querySelectorAll(".profile-navigation__link"),sectionHeader=document.getElementById("ProfileHeader"),avatarFrame=document.querySelector(".lk-sidebar"),allNavLinks.forEach(function(e,t){4!==t&&(e.href.includes("tab=chat")&&pageLocation.includes("tab=chat")?(e.classList.add("profile-navigation__link--active"),sectionHeader.textContent=props[1],avatarFrame.classList.add("js--hidden")):e.href.includes("user")&&pageLocation.includes("user")&&!pageLocation.includes("chat")?(e.classList.add("profile-navigation__link--active"),sectionHeader.textContent=props[0]):e.href.includes("subscription")&&pageLocation.includes("subscription")&&e.classList.add("profile-navigation__link--active"))}));
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZvcm1fQ3VzdG9tQ2hlY2tib3guanMiLCJmb3JtX0N1c3RvbVNlbGVjdC5qcyIsImZvcm1fU2xpZGVyLmpzIiwiZm9ybV9VcGRhdGVQcmVmcy5qcyIsInBsdWdpbl9Td2lwZXJDb25maWcuanMiLCJwcmVmc19UZXN0TG9naWMuanMiLCJwcm9maWxlX0F1dGhvcml6YXRpb24uanMiLCJwcm9maWxlX0NoYXRTZXR0aW5ncy5qcyIsInByb2ZpbGVfTG9nU3RhdHVzLmpzIiwicHJvZmlsZV9Nb2JpbGVOYXZpZ2F0aW9uLmpzIiwicHJvZmlsZV9Mb2dvdXRCdXR0b24uanMiLCJwcm9maWxlX05hdmlnYXRpb24uanMiXSwibmFtZXMiOlsiY3VzdG9tU2VsZWN0Iiwic2VsZWN0Q29udGFpbmVyIiwic2VsZWN0T3B0aW9ucyIsInNhdmVkU3RyaW5nIiwiYnVkZ2V0SW5wdXQiLCJjaGVja2JveGVzUmVwYWlyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwicmVzZXRSZXBhaXIiLCJxdWVyeVNlbGVjdG9yIiwiY2hlY2tib3hlc0NvbGl2ZXIiLCJyZXNldENvbGl2ZXIiLCJjaGVja2JveGVzUm9vbSIsInJlc2V0Um9vbSIsInJlc2V0Q2hlY2tib3hSZXBhaXIiLCJjb250cm9sU3VtIiwiZm9yRWFjaCIsInJvb20iLCJjbGFzc0xpc3QiLCJjb250YWlucyIsInJlbW92ZSIsImFkZCIsInJlc2V0Q2hlY2tib3hDb2xpdmVyIiwicmVzZXRDaGVja2JveFJvb20iLCJyZXBhaXIiLCJhZGRFdmVudExpc3RlbmVyIiwiaW5uZXJfY2hlY2tib3giLCJ0b2dnbGUiLCJzZXRUaW1lb3V0IiwiY29saXZlciIsImdldEVsZW1lbnRCeUlkIiwidGV4dENvbnRlbnQiLCJ3aW5kb3ciLCJvbmNsaWNrIiwiZXZlbnQiLCJ0YXJnZXQiLCJvcHRpb24iLCJpbmRleCIsInJlcGxhY2UiLCJjb25jYXQiLCJzbGljZSIsImlubmVyX29wdGlvbiIsIiQiLCJzbGlkZXIiLCJyYW5nZSIsIm1pbiIsIm1heCIsInN0ZXAiLCJ2YWx1ZSIsInNsaWRlIiwidWkiLCJ2YWwiLCJ2YWx1ZUlucHV0Iiwic3VibWl0Rm9ybSIsInJvb21zQW1vdW50IiwiYnVkZ2V0IiwiYXJlYVNlYXJjaCIsInJlcGFpclByZWZzIiwiY29saXZlclByZWZzIiwicHJlZnNPYmplY3QiLCJnZXRSb29tc0Ftb3VudCIsImJveCIsInRyaW0iLCJsZW5ndGgiLCJnZXRSZXBhaXJQcmVmcyIsImdldEF0dHJpYnV0ZSIsImdldENvbGl2ZXJQcmVmcyIsImlucHV0Um9vbXMiLCJpbnB1dEJ1ZGdldCIsImlucHV0QXJlYSIsImlucHV0UmVwYWlycyIsImlucHV0Q29saXZlciIsInN1Ym1pdCIsInNsaWRlckNvbnRhaW5lcnMiLCJhbGxOZXh0QnV0dG9ucyIsInN3aXBlciIsInN3aXBlclBhZ2luYXRpb24iLCJTd2lwZXIiLCJzcGVlZCIsInNwYWNlQmV0d2VlbiIsInNsaWRlc1BlclZpZXciLCJlZmZlY3QiLCJkaXJlY3Rpb24iLCJsb29wIiwicGFnaW5hdGlvbiIsImVsIiwiY2xpY2thYmxlIiwiYWxsU2xpZGVzIiwiYWN0aXZhdGVGb3JtcyIsInNpZ25pbkZvcm0iLCJzaWdudXBGb3JtIiwiY2FwdGlvbkluIiwiY2FwdGlvblVwIiwiZm9ybVNpZ25JblJlYWwiLCJmb3JtU2lnblVwUmVhbCIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJidXR0b24iLCJhY2NvdW50Iiwib3BlbmVyIiwidGltZXJzIiwiZm9ybUNvbnRhaW5lciIsIm1vZGlmeVRpbWUiLCJ0aW1lciIsInRpbWVyVmFsdWUiLCJhY3RpdmF0ZUxvZ291dCIsImxvZ291dExpbmsiLCJsb2dvdXRMaW5rSW5OYXYiLCJocmVmIiwiZ2V0SXRlbSIsImFsbE5hdkxpbmtzIiwic2VjdGlvbkhlYWRlciIsImF2YXRhckZyYW1lIiwicGFnZUxvY2F0aW9uIiwibG9jYXRpb24iLCJwcm9wcyIsImluY2x1ZGVzIiwibGluayJdLCJtYXBwaW5ncyI6ImFBRUEsSUNBQUEsYUFD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WUFBQW9GLE1BQUEsR0FDQUgsWUFBQTlGLFVBQUFHLElBQUEsWUFBQSxHQUNBZ0csRUFBQVQsS0FBQVEsU0FBQSxNQUFBLEdBQ0FILGFBQUFHLFNBQUEsTUFBQSxHQUFBLENBQUFILGFBQUFHLFNBQUEsTUFBQSxHQUNBQyxFQUFBbkcsVUFBQUcsSUFBQSxrQ0FBQSxFQUNBMEYsY0FBQWhGLFlBQUFvRixNQUFBLElBQ0FFLEVBQUFULEtBQUFRLFNBQUEsY0FBQSxHQUNBSCxhQUFBRyxTQUFBLGNBQUEsR0FDQUMsRUFBQW5HLFVBQUFHLElBQUEsa0NBQUEsRUFHQSxDQUFBIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuLy8gY29uc3Qgcm9vbUNoZWNrcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jdXN0b20tY2hlY2tib3gnKTtcclxuY29uc3QgY2hlY2tib3hlc1JlcGFpciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5yZXBhaXJDaGVja2JveCcpO1xyXG5jb25zdCByZXNldFJlcGFpciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yZXNldENoZWNrYm94UmVwYWlyJyk7XHJcbmNvbnN0IGNoZWNrYm94ZXNDb2xpdmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbGl2ZXJDaGVja2JveCcpO1xyXG5jb25zdCByZXNldENvbGl2ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucmVzZXRDaGVja2JveENvbGl2ZXInKTtcclxuY29uc3QgY2hlY2tib3hlc1Jvb20gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucm9vbUNoZWNrYm94Jyk7XHJcbmNvbnN0IHJlc2V0Um9vbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yZXNldENoZWNrYm94Um9vbScpO1xyXG5cclxuXHJcblxyXG5jaGVja2JveGVzUmVwYWlyLmZvckVhY2gocmVwYWlyID0+IHtcclxuICAgIHJlcGFpci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICBpZiAoIXJlcGFpci5jbGFzc0xpc3QuY29udGFpbnMoJ3Jlc2V0Q2hlY2tib3hSZXBhaXInKSkge1xyXG4gICAgICAgICAgICByZXBhaXIuY2xhc3NMaXN0LnRvZ2dsZSgnY3VzdG9tLWNoZWNrYm94LS1hY3RpdmUnKTtcclxuICAgICAgICAgICAgc2V0VGltZW91dChyZXNldENoZWNrYm94UmVwYWlyLCAxMDApO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocmVwYWlyLmNsYXNzTGlzdC5jb250YWlucygncmVzZXRDaGVja2JveFJlcGFpcicpKSB7XHJcbiAgICAgICAgICAgIGNoZWNrYm94ZXNSZXBhaXIuZm9yRWFjaChpbm5lcl9jaGVja2JveCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpbm5lcl9jaGVja2JveC5jbGFzc0xpc3QucmVtb3ZlKCdjdXN0b20tY2hlY2tib3gtLWFjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgcmVzZXRSZXBhaXIuY2xhc3NMaXN0LmFkZCgnY3VzdG9tLWNoZWNrYm94LS1hY3RpdmUnKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG59KVxyXG5cclxuY2hlY2tib3hlc0NvbGl2ZXIuZm9yRWFjaChjb2xpdmVyID0+IHtcclxuICAgIGNvbGl2ZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgaWYgKCFjb2xpdmVyLmNsYXNzTGlzdC5jb250YWlucygncmVzZXRDaGVja2JveENvbGl2ZXInKSkge1xyXG4gICAgICAgICAgICBjb2xpdmVyLmNsYXNzTGlzdC50b2dnbGUoJ2N1c3RvbS1jaGVja2JveC0tYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQocmVzZXRDaGVja2JveENvbGl2ZXIsIDEwMCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChjb2xpdmVyLmNsYXNzTGlzdC5jb250YWlucygncmVzZXRDaGVja2JveENvbGl2ZXInKSkge1xyXG4gICAgICAgICAgICBjaGVja2JveGVzQ29saXZlci5mb3JFYWNoKGlubmVyX2NoZWNrYm94ID0+IHtcclxuICAgICAgICAgICAgICAgIGlubmVyX2NoZWNrYm94LmNsYXNzTGlzdC5yZW1vdmUoJ2N1c3RvbS1jaGVja2JveC0tYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICByZXNldENvbGl2ZXIuY2xhc3NMaXN0LmFkZCgnY3VzdG9tLWNoZWNrYm94LS1hY3RpdmUnKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG59KVxyXG5cclxuY2hlY2tib3hlc1Jvb20uZm9yRWFjaChyb29tID0+IHtcclxuICAgIHJvb20uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgcm9vbS5jbGFzc0xpc3QudG9nZ2xlKCdjdXN0b20tY2hlY2tib3gtLWFjdGl2ZScpO1xyXG4gICAgICAgIHNldFRpbWVvdXQocmVzZXRDaGVja2JveFJvb20sIDEwMCk7XHJcbiAgICB9KVxyXG59KVxyXG5cclxuXHJcbmZ1bmN0aW9uIHJlc2V0Q2hlY2tib3hSZXBhaXIoKSB7XHJcbiAgICBsZXQgY29udHJvbFN1bSA9IDA7XHJcbiAgICBjaGVja2JveGVzUmVwYWlyLmZvckVhY2gocm9vbSA9PiB7XHJcbiAgICAgICAgaWYgKHJvb20uY2xhc3NMaXN0LmNvbnRhaW5zKCdjdXN0b20tY2hlY2tib3gtLWFjdGl2ZScpKSB7XHJcbiAgICAgICAgICAgIGNvbnRyb2xTdW0rKztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNvbnRyb2xTdW0gPiAxKSB7XHJcbiAgICAgICAgICAgIHJlc2V0UmVwYWlyLmNsYXNzTGlzdC5yZW1vdmUoJ2N1c3RvbS1jaGVja2JveC0tYWN0aXZlJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY29udHJvbFN1bSA9PSAwKSB7XHJcbiAgICAgICAgICAgIHJlc2V0UmVwYWlyLmNsYXNzTGlzdC5hZGQoJ2N1c3RvbS1jaGVja2JveC0tYWN0aXZlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlc2V0Q2hlY2tib3hDb2xpdmVyKCkge1xyXG4gICAgbGV0IGNvbnRyb2xTdW0gPSAwO1xyXG4gICAgY2hlY2tib3hlc0NvbGl2ZXIuZm9yRWFjaChyb29tID0+IHtcclxuICAgICAgICBpZiAocm9vbS5jbGFzc0xpc3QuY29udGFpbnMoJ2N1c3RvbS1jaGVja2JveC0tYWN0aXZlJykpIHtcclxuICAgICAgICAgICAgY29udHJvbFN1bSsrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY29udHJvbFN1bSA+IDEpIHtcclxuICAgICAgICAgICAgcmVzZXRDb2xpdmVyLmNsYXNzTGlzdC5yZW1vdmUoJ2N1c3RvbS1jaGVja2JveC0tYWN0aXZlJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY29udHJvbFN1bSA9PSAwKSB7XHJcbiAgICAgICAgICAgIHJlc2V0Q29saXZlci5jbGFzc0xpc3QuYWRkKCdjdXN0b20tY2hlY2tib3gtLWFjdGl2ZScpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZXNldENoZWNrYm94Um9vbSgpIHtcclxuICAgIGxldCBjb250cm9sU3VtID0gMDtcclxuICAgIGNoZWNrYm94ZXNSb29tLmZvckVhY2gocm9vbSA9PiB7XHJcbiAgICAgICAgaWYgKHJvb20uY2xhc3NMaXN0LmNvbnRhaW5zKCdjdXN0b20tY2hlY2tib3gtLWFjdGl2ZScpKSB7XHJcbiAgICAgICAgICAgIGNvbnRyb2xTdW0rKztcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIGlmIChjb250cm9sU3VtID09IDApIHtcclxuICAgICAgICByZXNldFJvb20uY2xhc3NMaXN0LmFkZCgnY3VzdG9tLWNoZWNrYm94LS1hY3RpdmUnKTtcclxuICAgIH1cclxufVxyXG4iLCJpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1c3RvbVNlbGVjdCcpKSB7XHJcblxyXG4gICAgY29uc3QgY3VzdG9tU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1c3RvbVNlbGVjdCcpO1xyXG4gICAgY29uc3Qgc2VsZWN0Q29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByZWYtc2xpZGVfX3NlbGVjdC1jb250YWluZXInKTtcclxuICAgIGNvbnN0IHNlbGVjdE9wdGlvbnMgPSBzZWxlY3RDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLnByZWYtc2xpZGVfX29wdGlvbicpO1xyXG4gICAgbGV0IHNhdmVkU3RyaW5nID0gY3VzdG9tU2VsZWN0LnRleHRDb250ZW50O1xyXG5cclxuICAgIGN1c3RvbVNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgc2VsZWN0Q29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS1oaWRkZW4nKTtcclxuICAgICAgICB9LCAxMDApO1xyXG4gICAgfSlcclxuXHJcbiAgICB3aW5kb3cub25jbGljayA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIGlmIChldmVudC50YXJnZXQgIT0gc2VsZWN0Q29udGFpbmVyICYmICFldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwcmVmLXNsaWRlX19vcHRpb24nKSAmJiAhZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncHJlZi1zbGlkZV9fc2VsZWN0JykpIHtcclxuICAgICAgICAgICAgc2VsZWN0Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJqcy0taGlkZGVuXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG5cclxuICAgIHNlbGVjdE9wdGlvbnMuZm9yRWFjaCgob3B0aW9uLCBpbmRleCkgPT4ge1xyXG4gICAgICAgIG9wdGlvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgaWYgKGluZGV4ICE9IDApIHtcclxuICAgICAgICAgICAgICAgIHNlbGVjdE9wdGlvbnNbMF0uY2xhc3NMaXN0LnJlbW92ZSgncHJlZi1zbGlkZV9fb3B0aW9uLS1hY3RpdmUnKVxyXG4gICAgICAgICAgICAgICAgb3B0aW9uLmNsYXNzTGlzdC50b2dnbGUoJ3ByZWYtc2xpZGVfX29wdGlvbi0tYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICBjdXN0b21TZWxlY3QudGV4dENvbnRlbnQgPSBjdXN0b21TZWxlY3QudGV4dENvbnRlbnQucmVwbGFjZSgn0JLRgdC1INGA0LDQudC+0L3RiycsICcnKTtcclxuICAgICAgICAgICAgICAgIGlmIChjdXN0b21TZWxlY3QudGV4dENvbnRlbnQgPT0gJycpIHtcclxuICAgICAgICAgICAgICAgICAgICBjdXN0b21TZWxlY3QudGV4dENvbnRlbnQgPSBgJHtvcHRpb24udGV4dENvbnRlbnQuc2xpY2UoMCwgNSl9YFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjdXN0b21TZWxlY3QudGV4dENvbnRlbnQgPSBgJHtjdXN0b21TZWxlY3QudGV4dENvbnRlbnR9LCAke29wdGlvbi50ZXh0Q29udGVudC5zbGljZSgwLCA1KX1gXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RPcHRpb25zLmZvckVhY2goKGlubmVyX29wdGlvbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlubmVyX29wdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdwcmVmLXNsaWRlX19vcHRpb24tLWFjdGl2ZScpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIG9wdGlvbi5jbGFzc0xpc3QuYWRkKCdwcmVmLXNsaWRlX19vcHRpb24tLWFjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgY3VzdG9tU2VsZWN0LnRleHRDb250ZW50ID0gJ9CS0YHQtSDRgNCw0LnQvtC90YsnO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG59IiwiaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1c2VyQnVkZ2V0SW5wdXQnKSkge1xyXG5cclxuICAgICQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICQoXCIjdXNlckJ1ZGdldFwiKS5zbGlkZXIoe1xyXG4gICAgICAgICAgICByYW5nZTogXCJtaW5cIixcclxuICAgICAgICAgICAgbWluOiAwLFxyXG4gICAgICAgICAgICBtYXg6IDIwMDAwMCxcclxuICAgICAgICAgICAgc3RlcDogMTAwMCxcclxuICAgICAgICAgICAgdmFsdWU6IDUwMDAwLFxyXG4gICAgICAgICAgICBzbGlkZTogZnVuY3Rpb24gKGV2ZW50LCB1aSkge1xyXG4gICAgICAgICAgICAgICAgJChcIiN1c2VyQnVkZ2V0SW5wdXRcIikudmFsKHVpLnZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgYnVkZ2V0SW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlckJ1ZGdldElucHV0Jyk7XHJcblxyXG4gICAgYnVkZ2V0SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdmFsdWVJbnB1dCA9IGJ1ZGdldElucHV0LnZhbHVlO1xyXG4gICAgICAgICQoXCIjdXNlckJ1ZGdldFwiKS5zbGlkZXIoXCJ2YWx1ZVwiLCB2YWx1ZUlucHV0KTtcclxuICAgIH0pXHJcbn0iLCJcclxuXHJcbmNvbnN0IHN1Ym1pdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc3VibWl0Rm9ybScpO1xyXG5sZXQgcm9vbXNBbW91bnQgPSAnJztcclxubGV0IGJ1ZGdldCA9ICcnO1xyXG5sZXQgYXJlYVNlYXJjaCA9ICcnO1xyXG5sZXQgcmVwYWlyUHJlZnMgPSAnJztcclxubGV0IGNvbGl2ZXJQcmVmcyA9ICcnO1xyXG5cclxubGV0IHByZWZzT2JqZWN0ID0ge1xyXG4gICAgcm9vbXNBbW91bnQ6ICcnLFxyXG4gICAgYnVkZ2V0OiAnJyxcclxuICAgIGFyZWFTZWFyY2g6ICcnLFxyXG4gICAgcmVwYWlyUHJlZnM6ICcnLFxyXG4gICAgY29saXZlclByZWZzOiAnJyxcclxufVxyXG5cclxuc3VibWl0Rm9ybS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgIHN1Ym1pdEZvcm0uY2xhc3NMaXN0LmFkZCgnanMtLWluYWN0aXZlJylcclxuICAgIGdldFJvb21zQW1vdW50KCk7XHJcbiAgICBnZXRSZXBhaXJQcmVmcygpO1xyXG4gICAgZ2V0Q29saXZlclByZWZzKCk7XHJcbiAgICBidWRnZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlckJ1ZGdldElucHV0JykudmFsdWU7XHJcbiAgICBhcmVhU2VhcmNoID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1c3RvbVNlbGVjdCcpLnRleHRDb250ZW50O1xyXG4gICAgY29uc3QgaW5wdXRSb29tcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb29tc0Ftb3VudCcpO1xyXG4gICAgY29uc3QgaW5wdXRCdWRnZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnVkZ2V0QW1vdW50Jyk7XHJcbiAgICBjb25zdCBpbnB1dEFyZWEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXJlYVNlYXJjaCcpO1xyXG4gICAgY29uc3QgaW5wdXRSZXBhaXJzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlcGFpclByZWZzJyk7XHJcbiAgICBjb25zdCBpbnB1dENvbGl2ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29saXZlclByZWZzJyk7XHJcbiAgICBpbnB1dFJvb21zLnZhbHVlID0gcm9vbXNBbW91bnQ7XHJcbiAgICBpbnB1dEJ1ZGdldC52YWx1ZSA9IGJ1ZGdldDtcclxuICAgIGlucHV0QXJlYS52YWx1ZSA9IGFyZWFTZWFyY2g7XHJcbiAgICBpbnB1dFJlcGFpcnMudmFsdWUgPSByZXBhaXJQcmVmcztcclxuICAgIGlucHV0Q29saXZlci52YWx1ZSA9IGNvbGl2ZXJQcmVmcztcclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmVmc0Zvcm0nKS5zdWJtaXQoKTtcclxufSk7XHJcblxyXG5cclxuLy8gJChmdW5jdGlvbiAoKSB7XHJcbi8vICAgICAkKFwiI3ByZWZzRm9ybVwiKS5vbihcInN1Ym1pdFwiLCBmdW5jdGlvbiAoZSkge1xyXG4vLyAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbi8vICAgICAgICAgJC5hamF4KHtcclxuLy8gICAgICAgICAgICAgdHlwZTogXCJwb3N0XCIsXHJcbi8vICAgICAgICAgICAgIHVybDogJzw/cGhwIGFkbWluX3VybCggJ2FkbWluLSBhamF4LnBocCcgKT8+JyxcclxuLy8gICAgICAgICAgICAgZGF0YToge1xyXG4vLyAgICAgICAgICAgICBhY3Rpb246IFwidXBkYXRlX3ByZWZzXCIsXHJcbi8vICAgICAgICAgICAgIHJvb21zQW1vdW50OiBwcmVmc09iamVjdC5yb29tc0Ftb3VudCxcclxuLy8gICAgICAgICAgICAgYnVkZ2V0OiBwcmVmc09iamVjdC5idWRnZXQsXHJcbi8vICAgICAgICAgICAgIGFyZWFTZWFyY2g6IHByZWZzT2JqZWN0LmFyZWFTZWFyY2gsXHJcbi8vICAgICAgICAgICAgIHJlcGFpclByZWZzOiBwcmVmc09iamVjdC5yZXBhaXJQcmVmcyxcclxuLy8gICAgICAgICAgICAgY29saXZlclByZWZzOiBwcmVmc09iamVjdC5jb2xpdmVyUHJlZnMsXHJcbi8vICAgICAgICAgfSxcclxuLy8gICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbi8vICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSwgJ3Jlc3BvbnNlJyk7XHJcbi8vICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc3VjY2VzcycsICdzdGF0dXMnKTtcclxuLy8gICAgICAgICAgICAgfSxcclxuLy8gICAgICAgICB9KTtcclxuLy8gfSk7XHJcbi8vIH0pO1xyXG5cclxuZnVuY3Rpb24gZ2V0Um9vbXNBbW91bnQoKSB7XHJcbiAgICBjb25zdCByb29tc0NoZWNrYm94ZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucm9vbUNoZWNrYm94Jyk7XHJcbiAgICByb29tc0NoZWNrYm94ZXMuZm9yRWFjaChib3ggPT4ge1xyXG4gICAgICAgIGlmIChib3guY2xhc3NMaXN0LmNvbnRhaW5zKCdjdXN0b20tY2hlY2tib3gtLWFjdGl2ZScpKSB7XHJcbiAgICAgICAgICAgIGxldCB2YWx1ZSA9IGJveC50ZXh0Q29udGVudDtcclxuICAgICAgICAgICAgcm9vbXNBbW91bnQgKz0gdmFsdWU7XHJcbiAgICAgICAgICAgIHJvb21zQW1vdW50ICs9ICcsICdcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG4gICAgcm9vbXNBbW91bnQgPSByb29tc0Ftb3VudC50cmltKCk7XHJcbiAgICByb29tc0Ftb3VudCA9IHJvb21zQW1vdW50LnNsaWNlKDAsIHJvb21zQW1vdW50Lmxlbmd0aCAtIDEpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRSZXBhaXJQcmVmcygpIHtcclxuICAgIGNvbnN0IHJlcGFpcnNDaGVja2JveGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnJlcGFpckNoZWNrYm94Jyk7XHJcbiAgICByZXBhaXJzQ2hlY2tib3hlcy5mb3JFYWNoKGJveCA9PiB7XHJcbiAgICAgICAgaWYgKGJveC5jbGFzc0xpc3QuY29udGFpbnMoJ2N1c3RvbS1jaGVja2JveC0tYWN0aXZlJykpIHtcclxuICAgICAgICAgICAgbGV0IHZhbHVlID0gYm94LmdldEF0dHJpYnV0ZSgnZGF0YS12YWx1ZScpO1xyXG4gICAgICAgICAgICByZXBhaXJQcmVmcyArPSB2YWx1ZTtcclxuICAgICAgICAgICAgcmVwYWlyUHJlZnMgKz0gJywgJ1xyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbiAgICByZXBhaXJQcmVmcyA9IHJlcGFpclByZWZzLnRyaW0oKTtcclxuICAgIHJlcGFpclByZWZzID0gcmVwYWlyUHJlZnMuc2xpY2UoMCwgcmVwYWlyUHJlZnMubGVuZ3RoIC0gMSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldENvbGl2ZXJQcmVmcygpIHtcclxuICAgIGNvbnN0IGNvbGl2ZXJDaGVja2JveGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbGl2ZXJDaGVja2JveCcpO1xyXG4gICAgY29saXZlckNoZWNrYm94ZXMuZm9yRWFjaChib3ggPT4ge1xyXG4gICAgICAgIGlmIChib3guY2xhc3NMaXN0LmNvbnRhaW5zKCdjdXN0b20tY2hlY2tib3gtLWFjdGl2ZScpKSB7XHJcbiAgICAgICAgICAgIGxldCB2YWx1ZSA9IGJveC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdmFsdWUnKTtcclxuICAgICAgICAgICAgY29saXZlclByZWZzICs9IHZhbHVlO1xyXG4gICAgICAgICAgICBjb2xpdmVyUHJlZnMgKz0gJywgJ1xyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbiAgICBjb2xpdmVyUHJlZnMgPSBjb2xpdmVyUHJlZnMudHJpbSgpO1xyXG4gICAgY29saXZlclByZWZzID0gY29saXZlclByZWZzLnNsaWNlKDAsIGNvbGl2ZXJQcmVmcy5sZW5ndGggLSAxKTtcclxufVxyXG5cclxuXHJcbiIsIi8vIFN3aXBlciBTZWN0aW9uXHJcblxyXG5jb25zdCBzbGlkZXJDb250YWluZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnN3aXBlci1hZHQnKTtcclxuXHJcbnNsaWRlckNvbnRhaW5lcnMuZm9yRWFjaCgoc3dpcGVyLCBpbmRleCkgPT4ge1xyXG4gICAgY29uc3Qgc3dpcGVyUGFnaW5hdGlvbiA9IHN3aXBlci5xdWVyeVNlbGVjdG9yKCcuc3dpcGVyLXBhZ2luYXRpb24nKTtcclxuICAgIHN3aXBlci5jbGFzc0xpc3QuYWRkKGBzd2lwZXItYWR0LS0ke2luZGV4fWApO1xyXG4gICAgc3dpcGVyUGFnaW5hdGlvbi5jbGFzc0xpc3QuYWRkKGBzd2lwZXItcGFnaW5hdGlvbi0tJHtpbmRleH1gKTtcclxuICAgIGNvbnN0IGFkdFN3aXBlciA9IG5ldyBTd2lwZXIoYC5zd2lwZXItYWR0LS0ke2luZGV4fWAsIHtcclxuICAgICAgICBzcGVlZDogNDAwLFxyXG4gICAgICAgIHNwYWNlQmV0d2VlbjogMCxcclxuICAgICAgICBzbGlkZXNQZXJWaWV3OiAxLFxyXG4gICAgICAgIGVmZmVjdDogJ2NhcmRzJyxcclxuICAgICAgICBkaXJlY3Rpb246ICdob3Jpem9udGFsJyxcclxuICAgICAgICBsb29wOiB0cnVlLFxyXG4gICAgICAgIHBhZ2luYXRpb246IHtcclxuICAgICAgICAgICAgZWw6IGAuc3dpcGVyLXBhZ2luYXRpb24tLSR7aW5kZXh9YCxcclxuICAgICAgICAgICAgY2xpY2thYmxlOiB0cnVlLFxyXG4gICAgICAgIH0sXHJcbiAgICB9KVxyXG59KTsiLCJcclxuY29uc3QgYWxsTmV4dEJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucHJlZi1zbGlkZV9fYnV0dG9uJyk7XHJcbmNvbnN0IGFsbFNsaWRlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wcmVmLXNsaWRlJyk7XHJcbmFsbE5leHRCdXR0b25zLmZvckVhY2goKGJ1dHRvbiwgaW5kZXgpID0+IHtcclxuICAgIGlmIChpbmRleCAhPT0gMikge1xyXG4gICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgYWxsU2xpZGVzW2luZGV4XS5jbGFzc0xpc3QuYWRkKCdqcy0taGlkZGVuJyk7XHJcbiAgICAgICAgICAgIGFsbFNsaWRlc1tpbmRleCArIDFdLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS1oaWRkZW4nKTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG59KVxyXG4iLCJmdW5jdGlvbiBhY3RpdmF0ZUZvcm1zKCkge1xyXG4gICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zaWduaW4tZm9ybScpKSB7XHJcbiAgICAgICAgY29uc3Qgc2lnbmluRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zaWduaW4tZm9ybScpO1xyXG4gICAgICAgIGNvbnN0IHNpZ251cEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2lnbnVwLWZvcm0nKTtcclxuICAgICAgICBjb25zdCBjYXB0aW9uSW4gPSBzaWduaW5Gb3JtLnF1ZXJ5U2VsZWN0b3IoJy5jYXB0aW9uJyk7XHJcbiAgICAgICAgY29uc3QgY2FwdGlvblVwID0gc2lnbnVwRm9ybS5xdWVyeVNlbGVjdG9yKCcuY2FwdGlvbicpO1xyXG4gICAgICAgIGNvbnN0IGZvcm1TaWduSW5SZWFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NpZ25pbi1zcGVjaWFsJyk7XHJcbiAgICAgICAgY29uc3QgZm9ybVNpZ25VcFJlYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2lnbnVwLXNwZWNpYWwnKTtcclxuICAgICAgICBjYXB0aW9uSW4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHNpZ25pbkZvcm0uY2xhc3NMaXN0LmFkZCgnanMtLWhpZGRlbicpO1xyXG4gICAgICAgICAgICBzaWdudXBGb3JtLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS1oaWRkZW4nKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIGNhcHRpb25VcC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgc2lnbmluRm9ybS5jbGFzc0xpc3QucmVtb3ZlKCdqcy0taGlkZGVuJyk7XHJcbiAgICAgICAgICAgIHNpZ251cEZvcm0uY2xhc3NMaXN0LmFkZCgnanMtLWhpZGRlbicpO1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGZvcm1TaWduSW5SZWFsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnbG9nZ2VkJywgdHJ1ZSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICBmb3JtU2lnblVwUmVhbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2xvZ2dlZCcsIHRydWUpXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxufVxyXG5cclxuc2V0VGltZW91dChhY3RpdmF0ZUZvcm1zLCAzMDApIiwiY29uc3QgdGltZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1lc3NhZ2UtdGltZScpO1xyXG5jb25zdCBmb3JtQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNoYXQtZm9ybScpO1xyXG5mdW5jdGlvbiBtb2RpZnlUaW1lKCkge1xyXG4gICAgdGltZXJzLmZvckVhY2godGltZXIgPT4ge1xyXG4gICAgICAgIGxldCB0aW1lclZhbHVlID0gdGltZXIudGV4dENvbnRlbnQ7XHJcbiAgICAgICAgdGltZXJWYWx1ZSA9IHRpbWVyVmFsdWUuc2xpY2UoMTEsIDE3KTtcclxuICAgICAgICB0aW1lci50ZXh0Q29udGVudCA9IHRpbWVyVmFsdWU7XHJcbiAgICB9KVxyXG59XHJcblxyXG5tb2RpZnlUaW1lKCk7XHJcblxyXG5cclxuXHJcbiIsImlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbG9nZ2VkJykpIHtcclxuICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbG9nZ2VkJykgPT0gJ3RydWUnKSB7XHJcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hY2NvdW50Jyk7XHJcbiAgICAgICAgYWNjb3VudC5jbGFzc0xpc3QuYWRkKCdhY2NvdW50LS1sb2dnZWQnKTtcclxuICAgIH1cclxufSIsImlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWVudU9wZW5lcicpKSB7XHJcbiAgICBjb25zdCBvcGVuZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWVudU9wZW5lcicpO1xyXG4gICAgb3BlbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgIG9wZW5lci5jbGFzc0xpc3QuYWRkKCdvcGVuZXItLWFjdGl2ZScpXHJcbiAgICB9KVxyXG4gICAgd2luZG93Lm9uY2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0ICE9IG9wZW5lciAmJiAhZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnY2hlY2tTcGFuJykpIHtcclxuICAgICAgICAgICAgb3BlbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJvcGVuZXItLWFjdGl2ZVwiKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59IiwiZnVuY3Rpb24gYWN0aXZhdGVMb2dvdXQoKSB7XHJcbiAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21lbnUtaGVhZGVyJykpIHtcclxuICAgICAgICBjb25zdCBtZW51SGVhYWRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtZW51LWhlYWRlcicpO1xyXG4gICAgICAgIGNvbnN0IGxvZ291dExpbmsgPSBtZW51SGVhYWRlci5xdWVyeVNlbGVjdG9yKCdhJyk7XHJcbiAgICAgICAgY29uc3QgbG9nb3V0TGlua0luTmF2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ291dExpbmsnKTtcclxuICAgICAgICBsb2dvdXRMaW5rSW5OYXYuaHJlZiA9IGxvZ291dExpbmsuaHJlZjtcclxuXHJcbiAgICAgICAgbG9nb3V0TGlua0luTmF2LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2xvZ2dlZCcpKSB7XHJcbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnbG9nZ2VkJywgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYWNjb3VudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hY2NvdW50Jyk7XHJcbiAgICAgICAgICAgICAgICBhY2NvdW50LmNsYXNzTGlzdC5yZW1vdmUoJ2FjY291bnQtLWxvZ2dlZCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxufVxyXG5cclxuc2V0VGltZW91dChhY3RpdmF0ZUxvZ291dCwgMzAwKSIsImNvbnN0IHBhZ2VMb2NhdGlvbiA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xyXG5jb25zdCBwcm9wcyA9IFsn0JLQsNGIINC/0YDQvtGE0LjQu9GMJywgJ9CS0LDRiNC4INGB0L7QvtCx0YnQtdC90LjRjyddO1xyXG5cclxuaWYgKHBhZ2VMb2NhdGlvbi5pbmNsdWRlcygncHJvZmlsZScpIHx8IHBhZ2VMb2NhdGlvbi5pbmNsdWRlcygnc3Vic2NyaXB0aW9uJykpIHtcclxuICAgIGNvbnN0IGFsbE5hdkxpbmtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnByb2ZpbGUtbmF2aWdhdGlvbl9fbGluaycpO1xyXG4gICAgY29uc3Qgc2VjdGlvbkhlYWRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdQcm9maWxlSGVhZGVyJyk7XHJcbiAgICBjb25zdCBhdmF0YXJGcmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5say1zaWRlYmFyJylcclxuICAgIGFsbE5hdkxpbmtzLmZvckVhY2goKGxpbmssIGluZGV4KSA9PiB7XHJcbiAgICAgICAgaWYgKGluZGV4ICE9PSA0KSB7XHJcbiAgICAgICAgICAgIGlmIChsaW5rLmhyZWYuaW5jbHVkZXMoJ3RhYj1jaGF0JylcclxuICAgICAgICAgICAgICAgICYmIHBhZ2VMb2NhdGlvbi5pbmNsdWRlcygndGFiPWNoYXQnKSkge1xyXG4gICAgICAgICAgICAgICAgbGluay5jbGFzc0xpc3QuYWRkKCdwcm9maWxlLW5hdmlnYXRpb25fX2xpbmstLWFjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgc2VjdGlvbkhlYWRlci50ZXh0Q29udGVudCA9IHByb3BzWzFdO1xyXG4gICAgICAgICAgICAgICAgYXZhdGFyRnJhbWUuY2xhc3NMaXN0LmFkZCgnanMtLWhpZGRlbicpXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobGluay5ocmVmLmluY2x1ZGVzKCd1c2VyJylcclxuICAgICAgICAgICAgICAgICYmIHBhZ2VMb2NhdGlvbi5pbmNsdWRlcygndXNlcicpICYmICFwYWdlTG9jYXRpb24uaW5jbHVkZXMoJ2NoYXQnKSkge1xyXG4gICAgICAgICAgICAgICAgbGluay5jbGFzc0xpc3QuYWRkKCdwcm9maWxlLW5hdmlnYXRpb25fX2xpbmstLWFjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgc2VjdGlvbkhlYWRlci50ZXh0Q29udGVudCA9IHByb3BzWzBdO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGxpbmsuaHJlZi5pbmNsdWRlcygnc3Vic2NyaXB0aW9uJylcclxuICAgICAgICAgICAgICAgICYmIHBhZ2VMb2NhdGlvbi5pbmNsdWRlcygnc3Vic2NyaXB0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgIGxpbmsuY2xhc3NMaXN0LmFkZCgncHJvZmlsZS1uYXZpZ2F0aW9uX19saW5rLS1hY3RpdmUnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbn0iXX0=
